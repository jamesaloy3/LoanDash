{"file_path":"null","system_message":"You are a loan-agreement extraction engine. Do ONLY what the schema requires and return valid JSON. Tasks:(1)Chunk by native hierarchy.(2)Extract ALL substantive items: definitions, monetary terms, interest, amortization, interest-only, prepayment, fees, reserves/escrows, covenants(financial/affirmative/negative/info), reporting, calculations/tests(DSCR/LTV/Debt Yield/make-whole), events of default, remedies, guaranties, collateral, transfers/assignments, tax/gross-up, insurance, indemnities, waivers/consents, notices, governing law, any bespoke legal provision.(3)Classify boilerplate vs bespoke with brief rationale.(4)Normalize money(number+ISO currency), percents(decimal), dates(YYYY-MM-DD if exact), durations(months).(5)For EVERY test/formula include formula_infix, variables(name/definition/units), threshold, comparator, testing_frequency, test_window/lookback, who_tests/enforces, grace/cure days, combined_debt flag and related notes if applicable.(6)Deduplicate canonicalize; add extra citations.Every item MUST include >=1 page citation and a verbatim quote <=1000 chars.No prose, no markdown.","user_message":"Analyze the attached loan agreement. Extract ALL terms, baskets, carve-outs, thresholds, triggers, cure rights, timing, reporting, and calculations. Distinguish boilerplate vs bespoke. Normalize values. Support multi-note/combined-debt covenants. Make sure the real parties are recorded, and the shell company.","response_schema":{"type":"object","required":["document","chunks","items","highlights","qc"],"properties":{"document":{"type":"object","required":["source_name","page_count"],"properties":{"source_name":{"type":"string","const":"22-LoanAgreement.pdf"},"title_guess":{"type":["string","null"]},"effective_date_iso":{"type":["string","null"],"pattern":"^\\d{4}-\\d{2}-\\d{2}$"},"governing_law":{"type":["string","null"]},"parties":{"type":"array","items":{"type":"object","required":["name","role"],"properties":{"name":{"type":"string"},"role":{"type":"string"}}}},"principal_amount":{"type":["number","null"]},"currency":{"type":["string","null"],"pattern":"^[A-Z]{3}$"},"maturity_date_iso":{"type":["string","null"],"pattern":"^\\d{4}-\\d{2}-\\d{2}$"},"page_count":{"type":"integer","minimum":1}}},"chunks":{"type":"array","items":{"type":"object","required":["chunk_id","title","page_start","page_end","heading_path","anchor_quote"],"properties":{"chunk_id":{"type":"string"},"title":{"type":"string"},"page_start":{"type":"integer","minimum":1},"page_end":{"type":"integer","minimum":1},"heading_path":{"type":"array","items":{"type":"string"}},"anchor_quote":{"type":"string","maxLength":500}}}},"items":{"type":"array","items":{"type":"object","required":["id","category","title","classification","citations"],"properties":{"id":{"type":"string"},"category":{"type":"string"},"title":{"type":"string"},"summary":{"type":["string","null"]},"tags":{"type":"array","items":{"type":"string"}},"classification":{"type":"object","required":["boilerplate_status","rationale"],"properties":{"boilerplate_status":{"type":"string"},"rationale":{"type":"string"}}},"normalization":{"type":"object","properties":{"amount_number":{"type":["number","null"]},"amount_currency":{"type":["string","null"],"pattern":"^[A-Z]{3}$"},"percent_decimal":{"type":["number","null"]},"rate_basis":{"type":["string","null"]},"date_iso":{"type":["string","null"],"pattern":"^\\d{4}-\\d{2}-\\d{2}$"},"duration_months":{"type":["integer","null"]},"frequency":{"type":["string","null"]},"comparator":{"type":["string","null"]},"threshold_value":{"type":["number","null"]},"units":{"type":["string","null"]},"original_text":{"type":["string","null"]}}},"substance":{"type":"object","properties":{"parties_involved":{"type":"array","items":{"type":"string"}},"metric_name":{"type":["string","null"]},"test_details":{"type":["object","null"],"properties":{"formula_infix":{"type":["string","null"]},"variables":{"type":"array","items":{"$ref":"#/$defs/variable"}},"threshold":{"type":["number","null"]},"comparator":{"type":["string","null"]},"testing_frequency":{"type":["string","null"]},"test_window":{"type":["string","null"]},"lookback":{"type":["string","null"]},"who_tests":{"type":["string","null"]},"who_enforces":{"type":["string","null"]},"grace_cure_days":{"type":["integer","null"]},"combined_debt":{"type":["boolean","null"]},"related_note_ids":{"type":"array","items":{"type":"string"}}}},"carve_outs":{"type":"array","items":{"type":"string"}},"baskets":{"type":"array","items":{"type":"string"}},"cure_rights":{"type":"array","items":{"type":"string"}},"triggers":{"type":"array","items":{"type":"string"}},"remedies":{"type":"array","items":{"type":"string"}},"timing":{"type":["string","null"]}}},"citations":{"type":"array","minItems":1,"items":{"$ref":"#/$defs/citation"}}}},"highlights":{"type":"array","items":{"type":"object","required":["item_id","why_notable"],"properties":{"item_id":{"type":"string"},"why_notable":{"type":"string"}}}},"qc":{"type":"object","properties":{"errors":{"type":"array","items":{"type":"string"}},"unknown_chunk_refs":{"type":"array","items":{"type":"string"}},"duplicate_item_ids":{"type":"array","items":{"type":"string"}},"empty_required_field_count":{"type":"integer","minimum":0},"stats":{"type":"object","properties":{"item_count":{"type":"integer","minimum":0},"citation_count":{"type":"integer","minimum":0}}}}}},"$defs":{"citation":{"type":"object","required":["page_start","page_end","verbatim_quote"],"properties":{"chunk_id":{"type":["string","null"]},"page_start":{"type":"integer","minimum":1},"page_end":{"type":"integer","minimum":1},"verbatim_quote":{"type":"string","maxLength":1000}}},"variable":{"type":"object","required":["name"],"properties":{"name":{"type":"string"},"definition":{"type":["string","null"]},"units":{"type":["string","null"]},"example_value":{"type":["number","null"]}}}}}
